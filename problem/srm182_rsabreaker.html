<html>
 <head>
  <title>RSABreaker Problem Statement</title>
 </head>
 <body>
  <table>
   <tbody>
    <tr>
     <td colspan="2"><h3><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=2310">Problem Statement for RSABreaker</a></h3></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td><i>This problem statement uses HTML elements which will not appear properly when viewing from some plugins. Please view the statement in the applet. </i><p>One of the most famous techniques in computer science is that of RSA encryption. To use it, we begin by choosing positive integers, e, n, d, and m, with the following properties. </p>
      <ul> 
       <li>1. n is divisible by no perfect squares larger than 1.</li> 
       <li>2. m is equal to the number of positive integers less than n that share no prime factors with n.</li> 
       <li>3. e * d has a remainder of 1 when divided by m.</li> 
      </ul> Then, given an integer a, between 0 and n-1 inclusive, we <i>encrypt</i> it as the remainder, again between 0 and n-1 inclusive, when a<sup>e</sup> is divided by n. Similarly, we <i>decrypt</i> an integer b, between 0 and n-1 inclusive, as the remainder, between 0 and n-1 inclusive, when b<sup>d</sup> is divided by n. Any kind of data can be decomposed as a list of such integers, and thus, any kind of data can be encrypted and decrypted in this way.<p></p> <p>For example, suppose e = 3, n = 10, d = 3, and m = 4. As required, </p>
      <ul> 
       <li> 1. n is divisible by no perfect squares larger than 1.</li> 
       <li> 2. There are precisely m positive integers less than n that share no prime factors with n, namely {1,3,7,9}.</li> 
       <li> 3. d*e = 9, which has a remainder of 1 when divided by m.</li> 
      </ul> We can thus use these values for RSA encryption. For example, we would encrypt 7 as 3, since 7<sup>e</sup> = 343, which has a remainder of 3 when divided by n. Then, we would decrypt 3 as 7, since 3<sup>d</sup> = 27, which has a remainder of 7 when divided by n.<p></p> <p>Suppose you want to allow people to send you encrypted messages that only you can read, but you have no way of meeting these people privately to agree upon a secret code. Remarkably, RSA encryption makes this possible. First of all, you choose e, n, d, and m satisfying the conditions described above. Then you announce the values of e and n, called the public key, to the entire world. Now, everybody has the information required to encrypt messages. To decrypt these messages, however, it is necessary to know d, called the private key, and only you know that. Other people could theoretically compute a legal value for d, given e and n, but nobody has found a practical method for doing this when n is large.</p> <p>When n is smaller, however, it is significantly easier to determine a legal private key, and hence to break RSA encryption. Create a class RSABreaker that contains a method decrypt, which is given an int <b>e</b>, an int <b>n</b>, and an int <b>b</b>, representing a public key and an encrypted integer. The method should return the decrypted value of <b>b</b>, as described above.</p> </td>
    </tr>
    <tr>
     <td colspan="2">&nbsp;</td>
    </tr>
    <tr>
     <td colspan="2"><h3>Definition</h3></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td>
      <table>
       <tbody>
        <tr>
         <td>Class:</td>
         <td>RSABreaker</td>
        </tr>
        <tr>
         <td>Method:</td>
         <td>decrypt</td>
        </tr>
        <tr>
         <td>Parameters:</td>
         <td>int, int, int</td>
        </tr>
        <tr>
         <td>Returns:</td>
         <td>int</td>
        </tr>
        <tr>
         <td>Method signature:</td>
         <td>int decrypt(int e, int n, int b)</td>
        </tr>
        <tr>
         <td colspan="2">(be sure your method is public)</td>
        </tr>
       </tbody>
      </table></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
    </tr>
    <tr>
     <td></td>
    </tr>
    <tr>
     <td colspan="2">&nbsp;</td>
    </tr>
    <tr>
     <td colspan="2"><h3>Notes</h3></td>
    </tr>
    <tr>
     <td align="center" valign="top">-</td>
     <td>There will always be multiple private keys compatible with each public key. Any one of them will decrypt messages correctly.</td>
    </tr>
    <tr>
     <td colspan="2">&nbsp;</td>
    </tr>
    <tr>
     <td colspan="2"><h3>Constraints</h3></td>
    </tr>
    <tr>
     <td align="center" valign="top">-</td>
     <td><b>e</b> will be between 1 and 1000 inclusive.</td>
    </tr>
    <tr>
     <td align="center" valign="top">-</td>
     <td><b>n</b> will be between 3 and 1000 inclusive.</td>
    </tr>
    <tr>
     <td align="center" valign="top">-</td>
     <td><b>n</b> will be divisible by no perfect squares larger than 1.</td>
    </tr>
    <tr>
     <td align="center" valign="top">-</td>
     <td><b>b</b> will be between 0 and <b>n</b>-1 inclusive.</td>
    </tr>
    <tr>
     <td align="center" valign="top">-</td>
     <td><b>e</b> and m (as computed above) will share no prime factors. This guarantees the existence of a legal private key.</td>
    </tr>
    <tr>
     <td colspan="2">&nbsp;</td>
    </tr>
    <tr>
     <td colspan="2"><h3>Examples</h3></td>
    </tr>
    <tr>
     <td align="center" nowrap="true">0)</td>
     <td></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td>
      <table>
       <tbody>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td><pre>3</pre></td>
            </tr>
            <tr>
             <td><pre>10</pre></td>
            </tr>
            <tr>
             <td><pre>3</pre></td>
            </tr>
           </tbody>
          </table></td>
        </tr>
        <tr>
         <td><pre>Returns: 7</pre></td>
        </tr>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td colspan="2">This is the example from the problem statement.</td>
            </tr>
           </tbody>
          </table></td>
        </tr>
       </tbody>
      </table></td>
    </tr>
    <tr>
     <td align="center" nowrap="true">1)</td>
     <td></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td>
      <table>
       <tbody>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td><pre>17</pre></td>
            </tr>
            <tr>
             <td><pre>33</pre></td>
            </tr>
            <tr>
             <td><pre>4</pre></td>
            </tr>
           </tbody>
          </table></td>
        </tr>
        <tr>
         <td><pre>Returns: 31</pre></td>
        </tr>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td colspan="2">The integers less than <b>n</b> sharing no prime factor with <b>n</b> are (1,2,4,5,7,8,10,13,14,16,17,19,20,23,25,26,28,29,31,32), so <b>m</b> = 20. We can then take d = 13 since 17*13 = 221, which has a remainder of 1 when divided by <b>m</b>. To decrypt 4, we take the remainder when 4<sup>e</sup> = 67108864 is divided by 33.</td>
            </tr>
           </tbody>
          </table></td>
        </tr>
       </tbody>
      </table></td>
    </tr>
    <tr>
     <td align="center" nowrap="true">2)</td>
     <td></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td>
      <table>
       <tbody>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td><pre>1</pre></td>
            </tr>
            <tr>
             <td><pre>42</pre></td>
            </tr>
            <tr>
             <td><pre>17</pre></td>
            </tr>
           </tbody>
          </table></td>
        </tr>
        <tr>
         <td><pre>Returns: 17</pre></td>
        </tr>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td colspan="2">In this case, m = 12 and we can take d = 1.</td>
            </tr>
           </tbody>
          </table></td>
        </tr>
       </tbody>
      </table></td>
    </tr>
    <tr>
     <td align="center" nowrap="true">3)</td>
     <td></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td>
      <table>
       <tbody>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td><pre>5</pre></td>
            </tr>
            <tr>
             <td><pre>997</pre></td>
            </tr>
            <tr>
             <td><pre>7</pre></td>
            </tr>
           </tbody>
          </table></td>
        </tr>
        <tr>
         <td><pre>Returns: 523</pre></td>
        </tr>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td colspan="2">Beware of overflow.</td>
            </tr>
           </tbody>
          </table></td>
        </tr>
       </tbody>
      </table></td>
    </tr>
   </tbody>
  </table>
 </body>
</html>