<html>
 <head>
  <title>PyramidPuzzle Problem Statement</title>
 </head>
 <body>
  <table>
   <tbody>
    <tr>
     <td colspan="2"><h3><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=8275">Problem Statement for PyramidPuzzle</a></h3></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td><p> In this task we will consider a mechanical puzzle that has the shape of a regular tetrahedron. Each edge is divided into <b>edgeLength</b> unit segments, and each face is divided into unit equilateral triangles. See the picture below for an example of a puzzle with <b>edgeLength</b>=3. </p> <p> On the real puzzle each of the small triangles is colored using one of four colors (red, green, blue, and yellow). The colors will not matter in this problem, but we will still use them in the pictures. </p> <p> <img src="http://www.topcoder.com/contest/problem/PyramidPuzzle/0-pyramid-small.png" /> </p> <p> Little Juliet is playing with the puzzle. Initially, she placed the puzzle on the table before her so that it was lying on one of its sides. Then she rotated it so that one vertex pointed towards her. This position of the pyramid will be called the canonical position. When a pyramid is in the canonical position, we can label the three edges of the bottom face as L (front left), R (front right) and B (back), as in the picture above. </p> <p> Little Juliet performed a sequence of moves, which left the puzzle in a scrambled state. Each of the moves was of one of these types: </p> 
      <ul> 
       <li>&quot;<tt>+X</tt>&quot;: Rotate the top X rows of the pyramid 120 degrees counter-clockwise (seen from above).</li> 
       <li>&quot;<tt>-X</tt>&quot;: Rotate the top X rows of the pyramid 120 degrees clockwise.</li> 
       <li>&quot;<tt>L</tt>&quot;: Flip the entire puzzle around the front left edge. The face that was previously the front left face is now the bottom face. Rotate the puzzle 60 degrees counter-clockwise and translate it back into the canonical position.</li> 
       <li>&quot;<tt>R</tt>&quot;: Flip the entire puzzle around the front right edge, rotate it 60 degrees counter-clockwise and translate it back into the canonical position.</li> 
       <li>&quot;<tt>B</tt>&quot;: Flip the entire puzzle around the back edge, rotate it 60 degrees counter-clockwise and translate it back into the canonical position.</li> 
      </ul> <p> <img src="http://www.topcoder.com/contest/problem/PyramidPuzzle/1-pyramid-rotated-small.png" /> &nbsp;&nbsp;&nbsp; <img src="http://www.topcoder.com/contest/problem/PyramidPuzzle/2-pyramid-back-small.png" /> </p> <p> The pictures above show the results of some of the moves, each starting with a puzzle in the canonical position, with the entire front left side being red, front right side green, back side blue and bottom side yellow. The first picture is an almost finished move <tt>-2</tt>. The second picture is the result of the move <tt>B</tt> (the bottom side is now blue). </p> <p> &nbsp; </p> <p> After seeing the scrambled puzzle, Juliet began to wonder whether repeating the exact same sequence of moves over and over again would bring it back to the initial state -- that is, each of the small triangles must return to the exact same place where it started. </p> <p> You are given an int <b>edgeLength</b> and a String[] <b>moves</b>. Concatenate the elements of <b>moves</b> to get a space-separated list of moves Juliet performed. </p> <p> If there is a positive integer K such that performing all the moves exactly K times brings each small triangle to the place where it was in the beginning, find the smallest such K and return the value (K mod 987654319). If no such K exists, return -1. </p></td>
    </tr>
    <tr>
     <td colspan="2">&nbsp;</td>
    </tr>
    <tr>
     <td colspan="2"><h3>Definition</h3></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td>
      <table>
       <tbody>
        <tr>
         <td>Class:</td>
         <td>PyramidPuzzle</td>
        </tr>
        <tr>
         <td>Method:</td>
         <td>repeatCount</td>
        </tr>
        <tr>
         <td>Parameters:</td>
         <td>int, String[]</td>
        </tr>
        <tr>
         <td>Returns:</td>
         <td>int</td>
        </tr>
        <tr>
         <td>Method signature:</td>
         <td>int repeatCount(int edgeLength, String[] moves)</td>
        </tr>
        <tr>
         <td colspan="2">(be sure your method is public)</td>
        </tr>
       </tbody>
      </table></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
    </tr>
    <tr>
     <td></td>
    </tr>
    <tr>
     <td colspan="2">&nbsp;</td>
    </tr>
    <tr>
     <td colspan="2"><h3>Notes</h3></td>
    </tr>
    <tr>
     <td align="center" valign="top">-</td>
     <td>When evaluating whether we are in the initial position, we can distinguish between triangles of the same color.</td>
    </tr>
    <tr>
     <td colspan="2">&nbsp;</td>
    </tr>
    <tr>
     <td colspan="2"><h3>Constraints</h3></td>
    </tr>
    <tr>
     <td align="center" valign="top">-</td>
     <td><b>edgeLength</b> will be between 3 and 50, inclusive.</td>
    </tr>
    <tr>
     <td align="center" valign="top">-</td>
     <td><b>moves</b> will contain between 1 and 50 elements, inclusive.</td>
    </tr>
    <tr>
     <td align="center" valign="top">-</td>
     <td>Each element in <b>moves</b> will contain between 0 and 50 characters, inclusive.</td>
    </tr>
    <tr>
     <td align="center" valign="top">-</td>
     <td><b>moves</b> will have the form described in the problem statement.</td>
    </tr>
    <tr>
     <td align="center" valign="top">-</td>
     <td><b>moves</b> will contain at least one move.</td>
    </tr>
    <tr>
     <td align="center" valign="top">-</td>
     <td>For moves of the first two types the integer X will be between 1 and <b>edgeLength</b>, inclusive, and it will be specified without leading zeroes.</td>
    </tr>
    <tr>
     <td colspan="2">&nbsp;</td>
    </tr>
    <tr>
     <td colspan="2"><h3>Examples</h3></td>
    </tr>
    <tr>
     <td align="center" nowrap="true">0)</td>
     <td></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td>
      <table>
       <tbody>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td><pre>3</pre></td>
            </tr>
            <tr>
             <td><pre>{&quot;-2&quot;}</pre></td>
            </tr>
           </tbody>
          </table></td>
        </tr>
        <tr>
         <td><pre>Returns: 3</pre></td>
        </tr>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td colspan="2">Three repetitions of this move bring the puzzle into the original state.</td>
            </tr>
           </tbody>
          </table></td>
        </tr>
       </tbody>
      </table></td>
    </tr>
    <tr>
     <td align="center" nowrap="true">1)</td>
     <td></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td>
      <table>
       <tbody>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td><pre>3</pre></td>
            </tr>
            <tr>
             <td><pre>{&quot;-2 +2 -2&quot;}</pre></td>
            </tr>
           </tbody>
          </table></td>
        </tr>
        <tr>
         <td><pre>Returns: 3</pre></td>
        </tr>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td colspan="2"><p> This sequence of moves has the same effect as a single <tt>-2</tt> move, thus we have to repeat it three times to get the initial position. </p></td>
            </tr>
           </tbody>
          </table></td>
        </tr>
       </tbody>
      </table></td>
    </tr>
    <tr>
     <td align="center" nowrap="true">2)</td>
     <td></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td>
      <table>
       <tbody>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td><pre>6</pre></td>
            </tr>
            <tr>
             <td><pre>{&quot;B &quot;,&quot;B&quot;}</pre></td>
            </tr>
           </tbody>
          </table></td>
        </tr>
        <tr>
         <td><pre>Returns: 3</pre></td>
        </tr>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td colspan="2">Flipping the entire puzzle backwards only leads to a few possible states.</td>
            </tr>
           </tbody>
          </table></td>
        </tr>
       </tbody>
      </table></td>
    </tr>
    <tr>
     <td align="center" nowrap="true">3)</td>
     <td></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td>
      <table>
       <tbody>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td><pre>7</pre></td>
            </tr>
            <tr>
             <td><pre>{&quot;+2 -1 +2 -1 +3 +2 -1 -3&quot;}</pre></td>
            </tr>
           </tbody>
          </table></td>
        </tr>
        <tr>
         <td><pre>Returns: 1</pre></td>
        </tr>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td colspan="2">A disguised identity.</td>
            </tr>
           </tbody>
          </table></td>
        </tr>
       </tbody>
      </table></td>
    </tr>
    <tr>
     <td align="center" nowrap="true">4)</td>
     <td></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td>
      <table>
       <tbody>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td><pre>3</pre></td>
            </tr>
            <tr>
             <td><pre>{&quot;-&quot;, &quot;2 L&quot;}</pre></td>
            </tr>
           </tbody>
          </table></td>
        </tr>
        <tr>
         <td><pre>Returns: 72</pre></td>
        </tr>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td colspan="2">Don't forget to concatenate the elements of <b>moves</b>.</td>
            </tr>
           </tbody>
          </table></td>
        </tr>
       </tbody>
      </table></td>
    </tr>
    <tr>
     <td align="center" nowrap="true">5)</td>
     <td></td>
    </tr>
    <tr>
     <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
     <td>
      <table>
       <tbody>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td><pre>50</pre></td>
            </tr>
            <tr>
             <td><pre>{&quot;B +50&quot;}</pre></td>
            </tr>
           </tbody>
          </table></td>
        </tr>
        <tr>
         <td><pre>Returns: 2</pre></td>
        </tr>
        <tr>
         <td>
          <table>
           <tbody>
            <tr>
             <td colspan="2">Note that <tt>+50</tt> rotates the entire pyramid, including the triangles on the bottom face.</td>
            </tr>
           </tbody>
          </table></td>
        </tr>
       </tbody>
      </table></td>
    </tr>
   </tbody>
  </table>
 </body>
</html>